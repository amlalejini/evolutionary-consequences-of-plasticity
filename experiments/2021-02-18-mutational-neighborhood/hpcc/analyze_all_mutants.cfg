
#######################################################
# Analyzes organisms in the specified population file #
#######################################################

SET i 200000
SET v unknown

FUNCTION SET_ENV_EVEN
  SET v env_even
  SetReactionValue NOT 1.0
  SetReactionValue NAND -1.0
  SetReactionValue AND 1.0
  SetReactionValue ORN -1.0
  SetReactionValue OR 1.0
  SetReactionValue ANDN -1.0
END

FUNCTION SET_ENV_ODD
  SET v env_odd
  SetReactionValue NOT -1.0
  SetReactionValue NAND 1.0
  SetReactionValue AND -1.0
  SetReactionValue ORN 1.0
  SetReactionValue OR -1.0
  SetReactionValue ANDN 1.0
END

FUNCTION ANALYZE_FILE
    # - One step mutants of org
    #   - env even  => BATCH 0
    #   - env odd   => BATCH 1
    PURGE_BATCH 0
    PURGE_BATCH 1
    # Load population (into batch 0, 6)
    SET_BATCH 0
    LOAD ./data/mutants/batch_$i.spop
    # find dominant genotype (duplicate into 1, 2)
    DUPLICATE 0 1

    #   - env even  => BATCH 0
    SET_BATCH 0
    SET_ENV_EVEN
    RECALC
    DETAIL ./data/mutant_data/$v/batch_$i.dat id update_born depth fitness length sequence gest_time merit efficiency task.0 task.1 task.2 task.3 task.4 task.5 task.6 task.7 task.8 parent_muts

    #   - env odd   => BATCH 1
    SET_BATCH 1
    SET_ENV_ODD
    RECALC
    DETAIL ./data/mutant_data/$v/batch_$i.dat id update_born depth fitness length sequence gest_time merit efficiency task.0 task.1 task.2 task.3 task.4 task.5 task.6 task.7 task.8 parent_muts
END


SET i 0
ANALYZE_FILE
SET i 1
ANALYZE_FILE
SET i 2
ANALYZE_FILE
SET i 3
ANALYZE_FILE
SET i 4
ANALYZE_FILE
SET i 5
ANALYZE_FILE
